FROM gliderlabs/alpine:3.3
MAINTAINER Tapglue "dev@tapglue.com"

ARG CONFIG_FILE

RUN apk add -U python curl ca-certificates

RUN apk --update add python py-pip openssl ca-certificates postgresql-dev
RUN apk --update add --virtual build-dependencies build-base python-dev \
  && pip install psycopg2 \
  && apk del build-dependencies

RUN curl -O https://repo.pganalyze.com/zip/pganalyze-collector.zip

ADD $CONFIG_FILE /.pganalyze_collector.conf

RUN chmod go-rwx /.pganalyze_collector.conf
